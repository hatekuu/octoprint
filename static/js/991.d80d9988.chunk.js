"use strict";(self.webpackChunkoctoprint=self.webpackChunkoctoprint||[]).push([[991],{3991:(e,n,i)=>{i.r(n),i.d(n,{default:()=>f});var t=i(5043),s=i(3402),l=i(579);const r=e=>{let{isOpen:n,onClose:i,printers:t,onSelectPrinter:s}=e;return n?(0,l.jsx)("div",{className:"modal-overlay",children:(0,l.jsxs)("div",{className:"modal-content",children:[(0,l.jsx)("button",{className:"modal-close",onClick:i,children:"X"}),(0,l.jsx)("h2",{children:"Select a Printer"}),(0,l.jsx)("div",{className:"printer-list",children:t&&t.length>0?t.map((e=>(0,l.jsxs)("div",{onClick:()=>s(e),className:"printer-item",children:[(0,l.jsx)("h3",{children:e.machineName}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"V\u1eadt li\u1ec7u:"})," ",e.material]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"M\xe0u:"})," ",e.color]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"S\u1ed1 file \u0111ang ch\u1edd:"})," ",e.queueLength]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Lo\u1ea1i m\xe1y:"})," ",e.type]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"T\u1ed1c \u0111\u1ed9:"})," ",e.speed]})]},e._id))):(0,l.jsx)("p",{children:"No printers available"})})]})}):null},o=new s.qw({id:"application-0-lpfzcpx"}),a=e=>{let{printer:n}=e;const[i,s]=(0,t.useState)(!1),[a,c]=(0,t.useState)(null),[d,u]=(0,t.useState)([]),[p,h]=(0,t.useState)(null),[m,g]=(0,t.useState)(0),[x,f]=(0,t.useState)(""),[j,y]=(0,t.useState)(!1);(0,t.useEffect)((()=>{var e,i,t,s;null!==n&&void 0!==n&&n.result&&(console.log("\u0111\xe2y l\xe0 b\xean gcode:",null===n||void 0===n?void 0:n.result[0]),u((null===n||void 0===n||null===(e=n.result[0])||void 0===e||null===(i=e.public)||void 0===i||null===(t=i.output)||void 0===t||null===(s=t.jsonData)||void 0===s?void 0:s.printer)||[]));"yes"===(null===n||void 0===n?void 0:n.press)&&v()}),[n]);const v=()=>{s(!0)};return(0,l.jsxs)("div",{className:"upload-container",children:[(0,l.jsx)("h2",{children:"Upload G-code File"}),(0,l.jsx)("input",{type:"file",accept:".gcode",onChange:e=>{const n=e.target.files[0];if(n){const e=(n.size/1048576).toFixed(2);e>5?(f("File size exceeds 5MB limit. Please select a smaller file."),h(null),g(0)):(h(n),g(parseFloat(e)),f(""))}}}),p&&(0,l.jsxs)("p",{children:["File size: ",m," MB"]}),(0,l.jsx)("button",{onClick:async()=>{if(p){y(!0);try{const e=o.currentUser;if(!e)return f("User not authenticated"),void y(!1);const n=new FileReader;n.onload=async n=>{const i=n.target.result,t=i.split("\n");let s="Unknown";if(t.length>1){const e=t[1].match(/;TIME:(\d+)/);e&&(s=parseInt(e[1],10))}if(a){const n=a._id,t={fileName:p.name,userId:e.id,fileSize:parseFloat(m),fileContent:i,printTime:s,printerId:n},l=await e.functions.uploadGcodeFile(t);l.success?(f("File uploaded successfully"),h(null),g(0),c(null),document.querySelector('input[type="file"]').value=null):(console.log(l.message),f("Error uploading file: "+l.message)),y(!1)}else alert("B\u1ea1n ph\u1ea3i ch\u1ecdn m\xe1y in"),y(!1)},n.readAsText(p)}catch(e){console.error("Error uploading file:",e),f("Error uploading file"),y(!1)}}else f("No file selected")},className:"btn btn-info",disabled:j||!p,children:j?"Uploading...":"Upload"}),x&&(0,l.jsx)("p",{children:x}),(0,l.jsx)(r,{isOpen:i,onClose:()=>{s(!1)},printers:d,onSelectPrinter:e=>{c(e),s(!1)}}),a&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{children:"Selected Printer:"}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"T\xean m\xe1y:"})," ",a.machineName]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"V\u1eadt li\u1ec7u:"})," ",a.material]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"M\xe0u:"})," ",a.color]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"File \u0111ang ch\u1edd:"})," ",a.queueLength]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Lo\u1ea1i m\xe1y:"})," ",a.type]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"T\u1ed1c \u0111\u1ed9:"})," ",a.speed]})]})]})};var c=i(6244),d=i(443),u=i(3413);const p=()=>(0,l.jsxs)("div",{className:"filter-products",children:[(0,l.jsx)("h3",{children:"Ch\u1ecdn s\u1ea3n ph\u1ea9m"}),(0,l.jsx)(c.Ay,{schema:u.ld.w,onSubmit:e=>{let{formData:n}=e;console.log("Printer data:",n)},validator:d.Ay,uiSchema:u.ld.o})]}),h=new s.qw({id:"application-0-lpfzcpx"}),m=e=>{let{selectPrinter:n}=e;const[i,s]=(0,t.useState)({}),[r,o]=(0,t.useState)({});(0,t.useEffect)((()=>{a()}),[]);const a=async()=>{try{var e,n,i,t,l,r;const a=await h.currentUser.functions.printerModule("dong");s(null===(e=a[0])||void 0===e||null===(n=e.public)||void 0===n||null===(i=n.input)||void 0===i?void 0:i.jsonSchema),o(null===(t=a[0])||void 0===t||null===(l=t.public)||void 0===l||null===(r=l.input)||void 0===r?void 0:r.uiSchema)}catch(a){console.log(a.error)}};return(0,l.jsxs)("div",{className:"select-printer",children:[(0,l.jsx)("h3",{children:"Ch\u1ecdn m\xe1y in"}),(0,l.jsx)(c.Ay,{schema:i,onSubmit:async e=>{let{formData:i}=e;try{const e=await h.currentUser.functions.printerModule(i);console.log(e);n({result:e,press:"yes"})}catch(t){console.log(t.error)}},validator:d.Ay,uiSchema:r})]})},g=()=>(0,l.jsx)("div",{className:"view-printing-files"}),x=new s.qw({id:"application-0-lpfzcpx"}),f=()=>{const[e,n]=(0,t.useState)("");(0,t.useEffect)((()=>{i()}),[]);const i=async()=>{try{var e,n,i;console.log(null===(e=x.currentUser)||void 0===e?void 0:e.accessToken),await(null===(n=x.currentUser)||void 0===n?void 0:n.refreshAccessToken()),x.currentUser&&""!==(null===(i=x.currentUser)||void 0===i?void 0:i.accessToken)||(window.location.href="/octoprint/login")}catch(t){console.log(t.error)}};return(0,l.jsxs)("div",{className:"home-container",children:[(0,l.jsx)(a,{printer:e}),(0,l.jsx)(m,{selectPrinter:e=>{n(e)}}),(0,l.jsx)(g,{}),(0,l.jsx)(p,{})]})}},3413:e=>{e.exports=JSON.parse('{"ld":{"w":{"title":"Filter Products","type":"object","required":["cardType","cardCategory","quantity","completionTime"],"properties":{"cardType":{"type":"string","title":"Lo\u1ea1i th\u1ebb","enum":["Magnetic Stripe Card","Regular Card"]},"cardCategory":{"type":"string","title":"Danh m\u1ee5c th\u1ebb","enum":["Hospital Card","Parking Card","Bank Card","Game Card","Personal Information Card"]},"quantity":{"type":"integer","title":"S\u1ed1 l\u01b0\u1ee3ng tr\xean","enum":[0,100,200,300,400,500,700,800,900,1000]},"completionTime":{"type":"integer","title":"Th\u1eddi gian ho\xe0ng th\xe0nh","enum":[10,20,30,40,50]}}},"o":{"cardType":{"ui:placeholder":"Ch\u1ecdn lo\u1ea1i th\u1ebb","ui:enumNames":["Th\u1ebb t\u1eeb","Th\u1ebb th\u01b0\u1eddng"]},"cardCategory":{"ui:placeholder":"Ch\u1ecdn danh m\u1ee5c th\u1ebb","ui:enumNames":["Th\u1ebb th\u1ebb b\u1ec7nh vi\u1ec7n","Th\u1ebb gi\u1eef xe","Th\u1ebb ng\xe2n h\xe0ng","Th\u1ebb Game","Danh thi\u1ebfp"]},"quantity":{"ui:placeholder":"S\u1ed1 l\u01b0\u1ee3ng mong mu\u1ed1n tr\xean"},"completionTime":{"ui:placeholder":"Th\u1eddi gian ho\xe0ng th\xe0nh"},"ui:options":{"submitButtonOptions":{"props":{"disabled":false,"className":"btn btn-info"},"norender":false,"submitText":"L\u1ecdc s\u1ea3n ph\u1ea9m"}}}},"kz":{"w":{"title":"Register","type":"object","required":["email","password","confirmPassword"],"properties":{"email":{"type":"string","title":"Email","format":"email"},"password":{"type":"string","title":"Password","minLength":6},"confirmPassword":{"type":"string","title":"Confirm Password","minLength":6}}},"o":{"password":{"ui:widget":"password","ui:placeholder":"M\u1eadt kh\u1ea9u"},"email":{"ui:placeholder":"Email"},"confirmPassword":{"ui:widget":"password","ui:placeholder":"X\xe1c nh\u1eadn m\u1eadt kh\u1ea9u"},"ui:options":{"submitButtonOptions":{"props":{"disabled":false,"className":"btn btn-info"},"norender":false,"submitText":"\u0110\u0103ng k\xfd"}}}},"iD":{"w":{"title":"Register","type":"object","required":["email","password"],"properties":{"email":{"type":"string","title":"Email"},"password":{"type":"string","title":"Password","minLength":6}}},"o":{"password":{"ui:widget":"password","ui:placeholder":"M\u1eadt kh\u1ea9u"},"email":{"ui:placeholder":"Email"},"confirmPassword":{"ui:widget":"password","ui:placeholder":"X\xe1c nh\u1eadn m\u1eadt kh\u1ea9u"},"ui:options":{"submitButtonOptions":{"props":{"disabled":false,"className":"btn btn-info"},"norender":false,"submitText":"\u0110\u0103ng nh\u1eadp"}}}}}')}}]);
//# sourceMappingURL=991.d80d9988.chunk.js.map