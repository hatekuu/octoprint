"use strict";(self.webpackChunkoctoprint=self.webpackChunkoctoprint||[]).push([[712],{9712:(e,n,s)=>{s.r(n),s.d(n,{default:()=>m});var l=s(5043),t=s(3402),i=s(579);const r=e=>{let{isOpen:n,onClose:s,printers:l,onSelectPrinter:t}=e;return n?(0,i.jsx)("div",{className:"modal-overlay",children:(0,i.jsxs)("div",{className:"modal-content",children:[(0,i.jsx)("button",{className:"modal-close",onClick:s,children:"X"}),(0,i.jsx)("h2",{children:"Select a Printer"}),(0,i.jsx)("div",{className:"printer-list",children:l&&l.length>0?l.map((e=>(0,i.jsxs)("div",{onClick:()=>t(e),className:"printer-item",children:[(0,i.jsx)("h3",{children:e.machineName}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"V\u1eadt li\u1ec7u:"})," ",e.material]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"M\xe0u:"})," ",e.color]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"S\u1ed1 file \u0111ang ch\u1edd:"})," ",e.queueLength]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Lo\u1ea1i m\xe1y:"})," ",e.type]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"T\u1ed1c \u0111\u1ed9:"})," ",e.speed]})]},e._id))):(0,i.jsx)("p",{children:"No printers available"})})]})}):null},c=new t.qw({id:"application-0-lpfzcpx"}),o=e=>{let{printer:n}=e;const[s,t]=(0,l.useState)(!1),[o,a]=(0,l.useState)(null),[d,u]=(0,l.useState)([]),[h,p]=(0,l.useState)(null),[x,j]=(0,l.useState)(0),[v,m]=(0,l.useState)(""),[g,f]=(0,l.useState)(!1);(0,l.useEffect)((()=>{var e,s,l,t;null!==n&&void 0!==n&&n.result&&u((null===n||void 0===n||null===(e=n.result[0])||void 0===e||null===(s=e.public)||void 0===s||null===(l=s.output)||void 0===l||null===(t=l.jsonData)||void 0===t?void 0:t.printer)||[]);"yes"===(null===n||void 0===n?void 0:n.press)&&y()}),[n]);const y=()=>{t(!0)};return(0,i.jsxs)("div",{className:"upload-container",children:[(0,i.jsx)("h2",{children:"Upload G-code File"}),(0,i.jsx)("input",{type:"file",accept:".gcode",onChange:e=>{const n=e.target.files[0];if(n){const e=(n.size/1048576).toFixed(2);e>5?(m("File size exceeds 5MB limit. Please select a smaller file."),p(null),j(0)):(p(n),j(parseFloat(e)),m(""))}}}),h&&(0,i.jsxs)("p",{children:["File size: ",x," MB"]}),(0,i.jsx)("button",{onClick:async()=>{if(h){f(!0);try{const e=c.currentUser;if(!e)return m("User not authenticated"),void f(!1);const n=new FileReader;n.onload=async n=>{const s=n.target.result,l=s.split("\n");let t="Unknown";if(l.length>1){const e=l[1].match(/;TIME:(\d+)/);e&&(t=parseInt(e[1],10))}if(o){const n=o._id,l={fileName:h.name,userId:e.id,fileSize:parseFloat(x),fileContent:s,duration:t,printerId:n},i=await e.functions.uploadGcodeFile(l);i.success?(m("File uploaded successfully"),p(null),j(0),a(null),document.querySelector('input[type="file"]').value=null):(console.log(i.message),m("Error uploading file: "+i.message)),f(!1)}else alert("B\u1ea1n ph\u1ea3i ch\u1ecdn m\xe1y in"),f(!1)},n.readAsText(h)}catch(e){console.error("Error uploading file:",e),m("Error uploading file"),f(!1)}}else m("No file selected")},className:"btn btn-info",disabled:g||!h,children:g?"Uploading...":"Upload"}),v&&(0,i.jsx)("p",{children:v}),(0,i.jsx)(r,{isOpen:s,onClose:()=>{t(!1)},printers:d,onSelectPrinter:e=>{a(e),t(!1)}}),o&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{children:"Selected Printer:"}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"T\xean m\xe1y:"})," ",o.machineName]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"V\u1eadt li\u1ec7u:"})," ",o.material]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"M\xe0u:"})," ",o.color]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"File \u0111ang ch\u1edd:"})," ",o.queueLength]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Lo\u1ea1i m\xe1y:"})," ",o.type]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"T\u1ed1c \u0111\u1ed9:"})," ",o.speed]})]})]})};var a=s(6244),d=s(443);const u=new t.qw({id:"application-0-lpfzcpx"}),h=()=>{const[e,n]=(0,l.useState)({}),[s,t]=(0,l.useState)({}),[r,c]=(0,l.useState)(null),[o,h]=(0,l.useState)(null),[p,x]=(0,l.useState)(!0),[j,v]=(0,l.useState)(!1),[m,g]=(0,l.useState)(null);(0,l.useEffect)((()=>{(async()=>{try{var e,s,l,i,r,c;const o=await u.currentUser.functions.OrderModule("dong");n(null===(e=o[0])||void 0===e||null===(s=e.public)||void 0===s||null===(l=s.input)||void 0===l?void 0:l.jsonSchema),t(null===(i=o[0])||void 0===i||null===(r=i.public)||void 0===r||null===(c=r.input)||void 0===c?void 0:c.uiSchema)}catch(o){h(o.message)}finally{x(!1)}})()}),[]);return p?(0,i.jsx)("div",{children:"Loading..."}):o?(0,i.jsxs)("div",{children:["Error: ",o]}):(0,i.jsxs)("div",{className:"filter-products",children:[(0,i.jsx)("h3",{children:"Ch\u1ecdn s\u1ea3n ph\u1ea9m"}),(0,i.jsx)(a.Ay,{schema:e,onSubmit:async e=>{let{formData:n}=e;try{var s,l,t;g(n);const e=await u.currentUser.functions.OrderModule(n);c(null===(s=e[0])||void 0===s||null===(l=s.public)||void 0===l||null===(t=l.output)||void 0===t?void 0:t.jsonData),v(!0)}catch(o){h(o.message)}},validator:d.Ay,uiSchema:s}),j&&r&&(0,i.jsx)("div",{className:"modal-overlay",children:(0,i.jsxs)("div",{className:"modal-content",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"T\xf4ng gi\xe1:"})," ",r.totalCost.toLocaleString(),"\u0111\u1ed3ng"]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Th\u1eddi gian ho\xe0ng th\xe0nh:"})," ",(e=>{const n=Math.floor(e),s=Math.round(24*(e-n));return"".concat(n," days ").concat(s," hours")})(r.totalProductionTime)]}),(0,i.jsx)("p",{children:"B\u1ea1n v\u1eabn mu\u1ed1n mua ch\u1ee9?"}),(0,i.jsx)("button",{onClick:()=>{v(!1),g(null)},children:"Kh\xf4ng"}),(0,i.jsx)("button",{onClick:async()=>{m.userId=u.currentUser.id;try{await u.currentUser.functions.AddToBills(m),alert("\u0110\u1eb7t h\xe0ng th\xe0nh c\xf4ng")}catch(o){console.log(o.error)}v(!1),g(null)},children:"C\xf3"})]})})]})},p=new t.qw({id:"application-0-lpfzcpx"}),x=e=>{let{selectPrinter:n}=e;const[s,t]=(0,l.useState)({}),[r,c]=(0,l.useState)({});(0,l.useEffect)((()=>{o()}),[]);const o=async()=>{try{var e,n,s,l,i,r;const o=await p.currentUser.functions.printerModule("dong");t(null===(e=o[0])||void 0===e||null===(n=e.public)||void 0===n||null===(s=n.input)||void 0===s?void 0:s.jsonSchema),c(null===(l=o[0])||void 0===l||null===(i=l.public)||void 0===i||null===(r=i.input)||void 0===r?void 0:r.uiSchema)}catch(o){console.log(o.error)}};return(0,i.jsxs)("div",{className:"select-printer",children:[(0,i.jsx)("h3",{children:"Ch\u1ecdn m\xe1y in"}),(0,i.jsx)(a.Ay,{schema:s,onSubmit:async e=>{let{formData:s}=e;try{const e=await p.currentUser.functions.printerModule(s);console.log(e);n({result:e,press:"yes"})}catch(l){console.log(l.error)}},validator:d.Ay,uiSchema:r})]})},j=()=>(0,i.jsx)("div",{className:"view-printing-files"}),v=new t.qw({id:"application-0-lpfzcpx"}),m=()=>{const[e,n]=(0,l.useState)("");(0,l.useEffect)((()=>{s()}),[]);const s=async()=>{try{var e,n,s;console.log(null===(e=v.currentUser)||void 0===e?void 0:e.accessToken),await(null===(n=v.currentUser)||void 0===n?void 0:n.refreshAccessToken()),v.currentUser&&""!==(null===(s=v.currentUser)||void 0===s?void 0:s.accessToken)||(window.location.href="/octoprint/login")}catch(l){console.log(l.error)}};return(0,i.jsxs)("div",{className:"home-container",children:[(0,i.jsx)(o,{printer:e}),(0,i.jsx)(x,{selectPrinter:e=>{n(e)}}),(0,i.jsx)(j,{}),(0,i.jsx)(h,{})]})}}}]);
//# sourceMappingURL=712.5bd889a5.chunk.js.map