"use strict";(self.webpackChunkoctoprint=self.webpackChunkoctoprint||[]).push([[182],{9182:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});var l=n(5043),o=n(3402),i=n(579);const s=new o.qw({id:"application-0-lpfzcpx"}),a=()=>{const[e,t]=(0,l.useState)(s.currentUser),[n,o]=(0,l.useState)(""),[a,c]=(0,l.useState)([]),[r,d]=(0,l.useState)(!1),[p,u]=(0,l.useState)(0),[h,f]=(0,l.useState)("");(0,l.useEffect)((()=>{e&&x()}),[e]);const x=async()=>{if(e){const t=e.mongoClient("mongodb-atlas").db("octoprint").collection("octoprintFileCloud"),n=await t.find({});c(n)}};return(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{children:"Upload G-code Files"}),(0,i.jsx)("input",{type:"file",accept:".gcode",onChange:async t=>{const n=t.target.files[0];if(n){if(n.size>5242880)return void f("File size exceeds 5MB. Please upload a smaller file.");d(!0),f("");const t=new FileReader;t.onprogress=e=>{e.lengthComputable&&u(e.loaded/e.total*100)},t.onload=async t=>{const l=t.target.result,o=btoa(l);try{const t=e.mongoClient("mongodb-atlas").db("octoprint").collection("octoprintFileCloud");await t.insertOne({fileName:n.name,fileContent:o}),alert("File uploaded successfully"),x()}catch(i){console.error("Error uploading file:",i)}finally{d(!1),u(0)}},t.readAsBinaryString(n)}}}),r&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{children:["Uploading... ",p.toFixed(2),"%"]}),(0,i.jsx)("progress",{value:p,max:"100"})]}),h&&(0,i.jsx)("p",{style:{color:"red"},children:h}),(0,i.jsx)("h2",{children:"Uploaded Files"}),(0,i.jsx)("ul",{children:a.map((e=>(0,i.jsxs)("li",{children:[e.fileName,(0,i.jsx)("button",{onClick:()=>(e=>{const t=atob(e);o(t)})(e.fileContent),children:"View Content"})]},e._id)))}),n&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{children:"File Content"}),(0,i.jsx)("pre",{children:n})]})]})}}}]);
//# sourceMappingURL=182.10c5cd7f.chunk.js.map